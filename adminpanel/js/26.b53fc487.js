(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"0293":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main-layout",[s("q-splitter",{staticClass:"full-height full-width",attrs:{"after-class":"q-splitter__right-panel",limits:[10,30]},scopedSlots:t._u([{key:"before",fn:function(){return[s("div",{staticClass:"flex column full-height "},[s("q-toolbar",{staticClass:"col-auto q-py-sm list-border"},[s("q-btn",{attrs:{flat:"",color:"grey-8",size:"mg","no-wrap":"",disable:0===t.checkedIds.length},on:{click:t.askDeleteCheckedGroups}},[s("Trash"),s("span",[t._v(t._s(t.countLabel))]),s("q-tooltip",[t._v("\n              "+t._s(t.$t("COREWEBCLIENT.ACTION_DELETE"))+"\n            ")])],1),s("q-btn",{attrs:{flat:"",color:"grey-8",size:"mg"},on:{click:t.routeCreateGroup}},[s("Add"),s("q-tooltip",[t._v("\n              "+t._s(t.$t("ADMINPANELWEBCLIENT.ACTION_CREATE_ENTITY_GROUP"))+"\n            ")])],1)],1),s("standard-list",{ref:"groupList",staticClass:"col-grow list-border",attrs:{items:t.groupItems,selectedItem:t.selectedGroupId,loading:t.loadingGroups,search:t.search,page:t.page,pagesCount:t.pagesCount,noItemsText:"ADMINPANELWEBCLIENT.INFO_NO_ENTITIES_GROUP",noItemsFoundText:"ADMINPANELWEBCLIENT.INFO_NO_ENTITIES_FOUND_GROUP"},on:{route:t.route,check:t.afterCheck},scopedSlots:t._u([{key:"right-icon",fn:function(t){return[s("q-item-section",{attrs:{side:""}},[s("team-group-icon",{attrs:{size:24,color:t.color}})],1)]}}])})],1)]},proxy:!0},{key:"after",fn:function(){return[s("router-view",{attrs:{deletingIds:t.deletingIds},on:{"group-created":t.handleCreateGroup,"cancel-create":t.route,"delete-group":t.askDeleteGroup}})]},proxy:!0}]),model:{value:t.listSplitterWidth,callback:function(e){t.listSplitterWidth=e},expression:"listSplitterWidth"}},[s("ConfirmDialog",{ref:"confirmDialog"})],1)],1)},r=[],i=(s("7db0"),s("d3b7"),s("d81d"),s("b0c0"),s("ac1f"),s("841c"),s("4de4"),s("fb6a"),s("2ef0")),n=s.n(i),a=s("4245"),u=s("21ac"),l=s("6bfe"),d=s("e539"),c=s("83d6"),p=s("713b"),h=s("96ec"),g=s("2287"),f=s("2e52"),I=s("3863"),E=s("952a"),m={name:"Groups",components:{MainLayout:p["a"],ConfirmDialog:h["a"],StandardList:g["a"],Add:f["a"],TeamGroupIcon:I["a"],Trash:E["a"]},data:function(){return{groups:[],selectedGroupId:0,loadingGroups:!1,totalCount:0,search:"",page:1,limit:c["a"].getEntitiesPerPage(),groupItems:[],checkedIds:[],justCreatedId:0,deletingIds:[],listSplitterWidth:l["a"].pInt(localStorage.getItem("groups-list-splitter-width"),20)}},computed:{currentTenantId:function(){return this.$store.getters["tenants/getCurrentTenantId"]},allGroups:function(){var t=this.$store.getters["groups/getGroups"];return l["a"].pArray(t[this.currentTenantId])},pagesCount:function(){return Math.ceil(this.totalCount/this.limit)},countLabel:function(){var t=this.checkedIds.length;return t>0?t:""}},watch:{$route:function(t,e){this.parseRoute()},currentTenantId:function(){"/groups"!==this.$route.path&&this.$router.push("/groups"),this.requestGroups()},allGroups:function(){var t=this;this.populate(),this.justCreatedId&&this.allGroups.find((function(e){return e.id===t.justCreatedId}))&&(this.groups.find((function(e){return e.id===t.justCreatedId}))&&this.route(this.justCreatedId),this.justCreatedId=0)},groups:function(){this.groups?this.groupItems=this.groups.map((function(t){return{id:t.id,title:t.name,checked:!1,disableCheck:t.isTeam,showRightIcon:t.isTeam}})):this.groupItems=[]},listSplitterWidth:function(){localStorage.setItem("groups-list-splitter-width",this.listSplitterWidth)}},mounted:function(){this.requestGroups(),this.parseRoute(),this.populate()},methods:{requestGroups:function(){this.$store.dispatch("groups/requestGroups",{tenantId:this.currentTenantId})},parseRoute:function(){if("/groups/create"===this.$route.path)this.selectedGroupId=0;else{var t,e,s,o,r,i,n=l["a"].pString(null===(t=this.$route)||void 0===t||null===(e=t.params)||void 0===e?void 0:e.search),a=l["a"].pPositiveInt(null===(s=this.$route)||void 0===s||null===(o=s.params)||void 0===o?void 0:o.page);this.search===n&&this.page===a&&0===this.justCreatedId||(this.search=n,this.page=a,this.populate());var u=l["a"].pNonNegativeInt(null===(r=this.$route)||void 0===r||null===(i=r.params)||void 0===i?void 0:i.id);this.selectedGroupId!==u&&(this.selectedGroupId=u)}},populate:function(){var t=this.search.toLowerCase(),e=""===t?this.allGroups:this.allGroups.filter((function(e){return-1!==e.name.toLowerCase().indexOf(t)}));this.totalCount=e.length;var s=this.limit*(this.page-1);this.groups=e.slice(s,s+this.limit)},route:function(){var t,e,s,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=(null===(t=this.$refs)||void 0===t||null===(e=t.groupList)||void 0===e?void 0:e.enteredSearch)||"",n=""!==i?"/search/".concat(i):"",a=(null===(s=this.$refs)||void 0===s||null===(o=s.groupList)||void 0===o?void 0:o.selectedPage)||1;this.search!==i&&(a=1);var u=a>1?"/page/".concat(a):"",l=r>0?"/id/".concat(r):"",d="/groups"+n+u+l;d!==this.$route.path&&this.$router.push(d)},routeCreateGroup:function(){this.$router.push("/groups/create")},handleCreateGroup:function(t){this.justCreatedId=t,this.route(),this.requestGroups()},afterCheck:function(t){this.checkedIds=t},askDeleteGroup:function(t){this.askDeleteGroups([t])},askDeleteCheckedGroups:function(){this.askDeleteGroups(this.checkedIds)},askDeleteGroups:function(t){var e,s;if(n.a.isFunction(null===this||void 0===this||null===(e=this.$refs)||void 0===e||null===(s=e.confirmDialog)||void 0===s?void 0:s.openDialog)){var o=1===t.length?this.groups.find((function(e){return e.id===t[0]})):null,r=o?o.name:"";this.$refs.confirmDialog.openDialog({title:r,message:this.$tc("ADMINPANELWEBCLIENT.CONFIRM_DELETE_GROUP_PLURAL",t.length),okHandler:this.deleteGroups.bind(this,t)})}},deleteGroups:function(t){var e=this;this.deletingIds=t,this.loadingGroups=!0,d["a"].sendRequest({moduleName:"Core",methodName:"DeleteGroups",parameters:{IdList:t,Type:"Group"}}).then((function(s){if(e.deletingIds=[],e.loadingGroups=!1,!0===s){var o,r,i,a;u["a"].showReport(e.$tc("ADMINPANELWEBCLIENT.REPORT_DELETE_ENTITIES_GROUP_PLURAL",t.length));var l=-1!==t.indexOf(e.selectedGroupId),d=(null===(o=e.$refs)||void 0===o||null===(r=o.groupList)||void 0===r?void 0:r.selectedPage)||1,c=e.groups.length===t.length&&d>1;c&&n.a.isFunction(null===(i=e.$refs)||void 0===i||null===(a=i.groupList)||void 0===a?void 0:a.decreasePage)?e.$refs.groupList.decreasePage():l?(e.route(),e.populate()):e.populate()}else u["a"].showError(e.$tc("ADMINPANELWEBCLIENT.ERROR_DELETE_ENTITIES_GROUP_PLURAL",t.length));e.requestGroups()}),(function(s){e.deletingIds=[],e.loadingGroups=!1,u["a"].showError(a["a"].getTextFromResponse(s,e.$tc("ADMINPANELWEBCLIENT.ERROR_DELETE_ENTITIES_GROUP_PLURAL",t.length))),e.requestGroups()}))}}},v=m,G=s("2877"),C=s("8562"),T=s("65c6"),L=s("9c40"),N=s("05c0"),_=s("4074"),R=s("eebe"),k=s.n(R),D=Object(G["a"])(v,o,r,!1,null,null,null);e["default"]=D.exports;k()(D,"components",{QSplitter:C["a"],QToolbar:T["a"],QBtn:L["a"],QTooltip:N["a"],QItemSection:_["a"]})}}]);