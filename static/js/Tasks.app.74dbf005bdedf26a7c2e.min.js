(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{"1xZj":function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("0h2I"),r=i("wd/R"),o=i("nKlx"),l=i("RN+F"),h=i("AFLV"),c=i("Yjhd"),u=i("JFZZ"),d=i("IAk5"),p=i("OgeD"),m=i("SQrT"),b=i("hPb3"),f=i("76Kh"),v=i("czxF"),y=i("1grR"),E=i("20Ah"),g=i("aM42"),k=i("KA8O"),C=i("gcGb"),A=i("tqo6"),D=i("w7/9"),T=i("nKzX");function S(){v.call(this),this.modified=!1,this.isPublic=d.isPublic(),this.isEditable=a.observable(!1),this.isEditableReminders=a.observable(!1),this.selectedCalendarIsShared=a.observable(!1),this.selectedCalendarIsEditable=a.observable(!1),this.selectedCalendarIsSubscribed=a.observable(!1),this.callbackSave=null,this.callbackDelete=null,this.timeFormatMoment="HH:mm",this.dateFormatMoment="MM/DD/YYYY",this.dateFormatDatePicker="mm/dd/yy",this.ampmTimeFormat=a.observable(!1),this.calendarId=a.observable(null),this.id=a.observable(null),this.uid=a.observable(null),this.recurrenceId=a.observable(null),this.allEvents=a.observable(Enums.CalendarEditRecurrenceEvent.AllEvents),this.isMyEvent=a.observable(!1),this.startDom=a.observable(null),this.endDom=a.observable(null),this.repeatEndDom=a.observable(null),this.yearlyDayText=a.observable(""),this.monthlyDayText=a.observable(""),this.subject=a.observable("").extend({disableLinebreaks:!0}),this.linkPopupEditableView=new T,this.descriptionView=new D({isEditableObservable:this.isEditable,autosizeTriggerObservable:this.autosizeTrigger,linkPopupEditableView:this.linkPopupEditableView,allowEditLinks:!0,placeholderText:l.i18n("CALENDARWEBCLIENT/LABEL_DESCRIPTION")}),this.locationView=new D({isEditableObservable:this.isEditable,autosizeTriggerObservable:this.autosizeTrigger,linkPopupEditableView:this.linkPopupEditableView,allowEditLinks:!1,placeholderText:l.i18n("CALENDARWEBCLIENT/LABEL_LOCATION")}),this.lockSelectStartEndDate=a.observable(!1),this.startDate=a.observable(""),this.startTime=a.observable(""),this.startTime.subscribe((function(){this.selectStartDate()}),this),this.allDay=a.observable(!1),this.allDay.subscribe((function(){this.allDay()||this.setActualTime()}),this),this.endDate=a.observable(""),this.endTime=a.observable(""),this.endTime.subscribe((function(){this.selectEndDate()}),this),this.repeatEndDate=a.observable(""),this.isEvOneDay=a.observable(!0),this.isEvOneTime=a.observable(!0),this.isRepeat=a.observable(!1),this.allowSetPrivateEvent=a.observable(!1),this.isPrivateEvent=a.observable(!1),this.repeatPeriodOptions=a.observableArray(this.getDisplayedPeriods()),this.repeatWeekIntervalOptions=a.observableArray([1,2,3,4]),this.defaultAlarms=a.observableArray([5,10,15,30,60,120,180,240,300,360,420,480,540,600,660,720,1080,1440,2880,4320,5760,10080,20160]),this.alarmOptions=a.observableArray([]),this.timeOptions=a.observableArray(g.getTimeListStepHalfHour(b.timeFormat()!==Enums.TimeFormat.F24?"hh:mm A":"HH:mm")),b.timeFormat.subscribe((function(){this.timeOptions(g.getTimeListStepHalfHour(b.timeFormat()!==Enums.TimeFormat.F24?"hh:mm A":"HH:mm"))}),this),this.displayedAlarms=a.observableArray([]),this.displayedAlarms.subscribe((function(){this.disableAlarms()}),this),this.excluded=a.observable(!1),this.repeatPeriod=a.observable(Enums.CalendarRepeatPeriod.None),this.repeatPeriod.subscribe((function(t){this.setDayOfWeek(),this.isRepeat(!!t)}),this),this.repeatInterval=a.observable(1),this.repeatCount=a.observable(null),this.repeatWeekNum=a.observable(null),this.weekMO=a.observable(!1),this.weekTU=a.observable(!1),this.weekWE=a.observable(!1),this.weekTH=a.observable(!1),this.weekFR=a.observable(!1),this.weekSA=a.observable(!1),this.weekSU=a.observable(!1),this.always=a.observable(1),this.appointment=a.observable(!1),this.attendees=a.observableArray([]),this.attenderStatus=a.observable(0),this.owner=a.observable(""),this.organizer=a.observable(""),this.recivedAnim=a.observable(!1).extend({autoResetToFalse:500}),this.whomAnimate=a.observable(""),this.guestAutocompleteItem=a.observable(null),this.guestAutocomplete=a.observable(""),this.guestEmailFocus=a.observable(!1),this.guestAutocomplete.subscribe((function(t){""===t&&this.guestAutocompleteItem(null)}),this),this.condition=a.observable(""),this.autosizeTrigger=a.observable(!0),this.calendars=null,this.calendarsList=a.observableArray([]),this.calendarColor=a.observable(""),this.selectedCalendarId=a.observable(""),this.selectedCalendarName=a.observable(""),this.selectedCalendarId.subscribe((function(t){if(t){var e=this.calendars.getCalendarById(t);this.owner(e.owner()),this.selectedCalendarName(e.name()),this.selectedCalendarIsShared(e.isShared()),this.selectedCalendarIsEditable(e.isEditable()&&!e.subscribed()),this.selectedCalendarIsSubscribed(e.subscribed()),this.changeCalendarColor(t),this.allowSetPrivateEvent(A.AllowPrivateEvents&&!e.isShared()&&!e.isSharedToAll())}}),this),this.subjectFocus=a.observable(!1),this.dateEdit=a.observable(!1),this.repeatEdit=a.observable(!1),this.guestsEdit=a.observable(!1),this.isEditForm=a.computed((function(){return!!this.id()}),this),this.callbackAttendeeActionDecline=null,this.additionalButtonControllers=a.observableArray([]),d.broadcastEvent("CalendarWebclient::RegisterEditEventController",{register:(t,e)=>{"AdditionalButton"===e&&this.additionalButtonControllers.push(t)},view:this}),this.bAllowAppointments=A.AllowAppointments,this.bAllowTasks=A.AllowTasks,this.eventType=a.observable("VEVENT"),this.status=a.observable(!1),this.isTask=a.observable(!1),this.isTaskApp=a.observable(!1),this.withDate=a.observable(!0),this.isTask.subscribe((function(t){this.eventType(t?"VTODO":"VEVENT")}),this),this.allChanges=a.computed((function(){this.subject(),this.descriptionView.dataHtml(),this.locationView.dataHtml(),this.isRepeat(),this.allDay(),this.repeatPeriod(),this.repeatInterval(),this.repeatCount(),this.repeatWeekNum(),this.startDate(),this.startTime(),this.endDate(),this.endTime(),this.repeatEndDate(),this.displayedAlarms(),this.weekMO(),this.weekTU(),this.weekWE(),this.weekTH(),this.weekFR(),this.weekSA(),this.weekSU(),this.always(),this.attendees(),this.selectedCalendarId(),this.status(),this.isTask(),this.withDate(),this.isPrivateEvent(),this.modified=!0}),this),this.aReminderPhrase=l.i18n("CALENDARWEBCLIENT/INFO_REMINDER").split("%"),this.isAppointmentButtonsVisible=a.observable(!1)}s.extendOwn(S.prototype,v.prototype),S.prototype.PopupTemplate="CalendarWebclient_EditEventPopup",S.prototype.createDatePickerObject=function(t,e){n(t).datepicker({showOtherMonths:!0,selectOtherMonths:!0,monthNames:o.getMonthNamesArray(),dayNamesMin:l.i18n("COREWEBCLIENT/LIST_DAY_NAMES_MIN").split(" "),nextText:"",prevText:"",firstDay:A.WeekStartsOn,showOn:"both",buttonText:" ",dateFormat:this.dateFormatDatePicker,onSelect:e}),n(t).mousedown((function(){n("#ui-datepicker-div").toggle()}))},S.prototype.initializeDatePickers=function(){this.createDatePickerObject(this.startDom(),this.selectStartDate.bind(this)),this.createDatePickerObject(this.endDom(),this.selectEndDate.bind(this)),this.createDatePickerObject(this.repeatEndDom(),function(t){this.repeatEndDate(t)}.bind(this)),this.startDom().datepicker("option","dateFormat",this.dateFormatDatePicker),this.endDom().datepicker("option","dateFormat",this.dateFormatDatePicker),this.repeatEndDom().datepicker("option","dateFormat",this.dateFormatDatePicker)},S.prototype.onOpen=function(t){this.linkPopupEditableView.onOpen();var e=d.getUserPublicId(),i=null,a=null,o="",l=null,u="",p=r();this.withDate(!!t.Start&&!!t.End),t.Start||t.End||(p.minutes()>30?p.add(60-p.minutes(),"minutes"):p.minutes(30),p.seconds(0).milliseconds(0),t.Start=p,t.End=p.clone().add(30,"minutes")),i=t.End?t.End.clone():null,a=t.Start?t.Start.clone():null,this.iDiffInMinutes=null,this.eventType(t.Type||"VEVENT"),this.isTask("VTODO"===this.eventType()),this.calendarId(t.SelectedCalendar),this.calendars=t.Calendars,(l=this.calendars.getCalendarById(this.calendarId()))&&(u=l.owner()),this.callbackSave=t.CallbackSave,this.callbackDelete=t.CallbackDelete,this.callbackAttendeeActionDecline=t.CallbackAttendeeActionDecline,this.timeFormatMoment=t.TimeFormat,this.dateFormatMoment=c.getDateFormatForMoment(t.DateFormat),this.dateFormatDatePicker=g.getDateFormatForDatePicker(t.DateFormat),this.ampmTimeFormat(b.timeFormat()!==Enums.TimeFormat.F24),this.initializeDatePickers(),this.allDay(t.AllDay),a&&(this.setStartDate(a,!0),this.startTime(a.format(this.timeFormatMoment))),i&&this.allDay()&&i.subtract(1,"days"),!i&&a&&(i=a),i&&(this.setEndDate(i,!0),this.endTime(i.format(this.timeFormatMoment))),this.calendars&&this.calendarsList(s.filter(this.calendars.collection(),(function(t){return t.isEditable()&&!t.subscribed()}))),this.selectedCalendarId(t.SelectedCalendar),this.selectedCalendarId.valueHasMutated(),this.changeCalendarColor(this.selectedCalendarId()),this.id(t.ID||null),this.uid(t.Uid||null),this.recurrenceId(t.RecurrenceId||null),this.subject(t.Subject||""),this.status(t.Status||!1),this.locationView.setPlain(t.Location),this.descriptionView.setHtml(t.Description),this.allEvents(t.AllEvents||Enums.CalendarEditRecurrenceEvent.AllEvents),this.isTaskApp(t.IsTaskApp||!1),this.populateAlarms(t.Alarms),this.organizer(h.pString(t.Organizer)),this.appointment(t.Appointment),this.attendees(t.Attendees||[]),n.isFunction(d.getAttendee)&&(o=d.getAttendee(this.attendees())),this.isMyEvent(o!==e&&(e===t.Owner||e===u)),this.editableSwitch(this.selectedCalendarIsShared(),this.selectedCalendarIsEditable(),this.isMyEvent(),this.selectedCalendarIsSubscribed()),this.setCurrentAttenderStatus(o,t.Attendees||[]),this.owner(t.Owner||e),this.guestAutocomplete(""),this.excluded(t.Excluded||!1),this.repeatRuleParse(t.RRule||null),null===this.id()&&this.subjectFocus(!0),this.autosizeTrigger.notifySubscribers(!0),this.modified=!1,this.isAppointmentButtonsVisible(this.appointment()&&this.selectedCalendarIsEditable()&&s.find(this.attendees(),(function(t){return t.email===e}))),this.isPrivateEvent(!!t.IsPrivate)},S.prototype.changeCalendarColor=function(t){if(n.isFunction(this.calendars.getCalendarById)){var e=this.calendars.getCalendarById(t);e&&(this.calendarColor(""),this.calendarColor(e.color()))}},S.prototype.onIsTaskClick=function(){this.eventType("VTODO"===this.eventType()?"VEVENT":"VTODO")},S.prototype.onSaveClick=function(){if(""===this.subject())f.showPopup(y,[l.i18n("CALENDARWEBCLIENT/ERROR_SUBJECT_BLANK"),s.bind((function(){this.subjectFocus(!0)}),this)]);else{if(this.callbackSave){var t=h.pInt(this.repeatPeriod()),e="",i=null,n=0,a=r(this.getDateTime(this.startDom(),this.startTime())),o=r(this.getDateTime(this.endDom(),this.endTime())),c={calendarId:this.calendarId(),newCalendarId:this.selectedCalendarId(),id:this.id(),uid:this.uid(),recurrenceId:this.recurrenceId(),allEvents:this.allEvents(),subject:this.subject(),title:g.getTitleForEvent(this.subject(),this.descriptionView.getPlain()),allDay:this.allDay(),location:this.locationView.getPlain(),description:this.descriptionView.getHtml(),alarms:this.getAlarmsArray(this.displayedAlarms()),attendees:this.attendees(),owner:this.owner(),modified:this.modified,type:this.eventType(),status:this.status(),withDate:this.withDate(),isPrivate:this.allowSetPrivateEvent()&&this.isPrivateEvent()},u=h.pInt(this.always());this.allDay()&&o.add(1,"days"),c.start=a,c.end=o,t&&(i=(e=this.repeatEndDom().datepicker("getDate"))?r(e).unix():null,n=this.repeatInterval(),t===Enums.CalendarRepeatPeriod.Daily&&u===Enums.CalendarAlways.Disable?c.rrule={byDays:[],count:null,end:2,interval:1,period:t,until:i,weekNum:null}:t===Enums.CalendarRepeatPeriod.Weekly&&u===Enums.CalendarAlways.Disable?(this.setDayOfWeek(),c.rrule={byDays:this.getDays(),count:null,end:2,interval:n,period:t,until:i,weekNum:null}):t===Enums.CalendarRepeatPeriod.Monthly||t===Enums.CalendarRepeatPeriod.Yearly?c.rrule={byDays:[],count:null,end:0,interval:1,period:t,until:null,weekNum:null}:t===Enums.CalendarRepeatPeriod.Daily&&u===Enums.CalendarAlways.Enable?c.rrule={byDays:[],count:null,end:3,interval:1,period:t,until:i,weekNum:null}:t===Enums.CalendarRepeatPeriod.Weekly&&u===Enums.CalendarAlways.Enable&&(this.setDayOfWeek(),c.rrule={byDays:this.getDays(),count:null,end:3,interval:n,period:t,until:i,weekNum:null})),this.callbackSave(c)}this.closePopup()}},S.prototype.onEscHandler=function(){this.dateEdit()?this.dateEdit(!1):this.closePopup()},S.prototype.onClose=function(){this.linkPopupEditableView.onClose(),this.hideAll(),this.cleanAll()},S.prototype.hideAll=function(){this.dateEdit(!1),this.repeatEdit(!1),this.guestsEdit(!1)},S.prototype.cleanAll=function(){this.isTask()?this.withDate(!1):this.withDate(!0),this.isTask(!1),this.subject(""),this.descriptionView.setHtml(""),this.locationView.setPlain(""),this.isRepeat(!1),this.allDay(!1),this.repeatPeriod(Enums.CalendarRepeatPeriod.None),this.repeatInterval(1),this.repeatCount(null),this.repeatWeekNum(null),this.startDate(""),this.startTime(""),this.endDate(""),this.endTime(""),this.repeatEndDate(""),this.displayedAlarms([]),this.weekMO(!1),this.weekTU(!1),this.weekWE(!1),this.weekTH(!1),this.weekFR(!1),this.weekSA(!1),this.weekSU(!1),this.attendees([]),this.always(1),this.selectedCalendarId(""),this.isPrivateEvent(!1),this.attendees([])},S.prototype.onDeleteClick=function(){if(this.callbackDelete){var t={calendarId:this.selectedCalendarId(),id:this.id(),uid:this.uid(),recurrenceId:this.recurrenceId(),allEvents:this.allEvents(),subject:this.subject(),title:g.getTitleForEvent(this.subject(),this.descriptionView.getPlain()),start:r(this.getDateTime(this.startDom(),this.startTime())),end:r(this.getDateTime(this.endDom(),this.endTime())),allDay:this.allDay(),location:this.locationView.getPlain(),description:this.descriptionView.getHtml()};this.callbackDelete(t)}this.closePopup()},S.prototype.showDates=function(t,e){e.stopPropagation(),this.dateEdit(!this.dateEdit())},S.prototype.showGuests=function(){if(this.attendees().length>0){var t=l.i18n("CALENDARWEBCLIENT/CONFIRM_REMOVE_ALL_ATTENDEES"),e=s.bind((function(t){t&&(this.guestsEdit(!1),this.guestEmailFocus(!1),this.attendees([]))}),this);f.showPopup(E,[t,e])}else this.guestsEdit(!this.guestsEdit()),this.guestEmailFocus(!this.guestEmailFocus())},S.prototype.onAddGuestClick=function(){var t=this.guestAutocompleteItem(),e=this.guestAutocomplete(),i=t||{name:"",email:e},n=s.any(this.attendees(),(function(t){return t.email===i.email}));""===i.email?m.showError(l.i18n("CALENDARWEBCLIENT/ERROR_EMAIL_BLANK")):i.email===this.owner()||n?this.recivedAnim(!0):this.attendees.push({status:0,name:i.name,email:i.email}),this.whomAnimate(i.email),this.guestAutocomplete(""),this.guestEmailFocus(!0)},S.prototype.populateAlarms=function(t){t?(this.alarmOptions(this.getDisplayedAlarms(s.union(this.defaultAlarms(),t))),this.displayedAlarms(this.getDisplayedAlarms(t))):this.alarmOptions(this.getDisplayedAlarms(this.defaultAlarms()))},S.prototype.getDisplayedAlarms=function(t){var e=[];return t&&s.each(t,(function(t,i){var s=this["alarm"+t]=a.observable(t),n="";s.subscribe((function(){this.disableAlarms(),this.modified=!0}),this),n=t>0&&t<60?l.i18n("COREWEBCLIENT/LABEL_MINUTES_PLURAL",{COUNT:t},null,t):t>=60&&t<1440?l.i18n("CALENDARWEBCLIENT/LABEL_HOURS_PLURAL",{COUNT:t/60},null,t/60):t>=1440&&t<10080?l.i18n("CALENDARWEBCLIENT/LABEL_DAYS_PLURAL",{COUNT:t/1440},null,t/1440):l.i18n("CALENDARWEBCLIENT/LABEL_WEEKS_PLURAL",{COUNT:t/10080},null,t/10080),e.push({value:t,alarm:s,text:n,isDisabled:!1})}),this),s.sortBy(e,(function(t){return t.value}))},S.prototype.getDisplayedPeriods=function(){return[{label:l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_NEVER"),value:0},{label:l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_DAILY"),value:1},{label:l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_WEEKLY"),value:2},{label:l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_MONTHLY"),value:3},{label:l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_YEARLY"),value:4}]},S.prototype.getAlarmsArray=function(t){var e=[];return s.each(t,(function(t,i){e.push(t.alarm())}),this),s.sortBy(e,(function(t){return-t}))},S.prototype.addFirstAlarm=function(){if(this.displayedAlarms().length){var t=l.i18n("CALENDARWEBCLIENT/CONFIRM_REMOVE_ALL_ALARMS"),e=s.bind((function(t){t&&this.displayedAlarms.removeAll()}),this);f.showPopup(E,[t,e])}else this.displayedAlarms(this.getDisplayedAlarms([this.alarmOptions()[0].value]))},S.prototype.addAlarm=function(){var t,e,i=0;e=s.sortBy(this.displayedAlarms(),(function(t){return t.alarm()})),s.each(e,(function(t){var e=t.alarm();5!==e&&i<=5?i=5:10!==e&&i<=10?i=10:15!==e&&i<=15?i=15:30!==e&&i<=30?i=30:1440!==e&&i<=1440&&(i=1440)})),t=this.getDisplayedAlarms([i])[0],this["alarm"+i]=a.observable(i),this.displayedAlarms.push(t)},S.prototype.removeAlarm=function(t){this.displayedAlarms.remove(t)},S.prototype.removeGuest=function(t){this.attendees.remove(t)},S.prototype.disableAlarms=function(){s.each(this.alarmOptions(),(function(t,e){t.isDisabled=s.any(this.displayedAlarms(),(function(e){return e.alarm()===t.value}))}),this),this.alarmOptions.valueHasMutated()},S.prototype.autocompleteCallback=function(t,e){const i={exceptEmail:this.owner()},n=p.run("ContactsWebclient","getSuggestionsAutocompleteCallback",[i]);s.isFunction(n)&&(this.guestAutocompleteItem(null),n(t,e))},S.prototype.repeatRuleParse=function(t){var e=this.allEvents();if(this.repeatEndDom().datepicker("option","minDate",this.getDateTime(this.endDom())),t&&e===Enums.CalendarEditRecurrenceEvent.AllEvents){if(t.until){var i=new Date(1e3*t.until),n=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds());this.repeatEndDom().datepicker("setDate",n)}t.byDays.length&&s.each(t.byDays,(function(t){this["week"+t](!0)}),this),this.repeatPeriod(t.period),this.repeatInterval(t.interval),this.repeatCount(t.count),this.repeatWeekNum(t.weekNum),this.always(3===t.end?1:0)}},S.prototype.getDays=function(){var t=[];return this.weekMO()&&t.push("MO"),this.weekTU()&&t.push("TU"),this.weekWE()&&t.push("WE"),this.weekTH()&&t.push("TH"),this.weekFR()&&t.push("FR"),this.weekSA()&&t.push("SA"),this.weekSU()&&t.push("SU"),t},S.prototype.onMainPanelClick=function(){this.dateEdit()&&this.dateEdit(!1)},S.prototype.getDateWithoutYearIfMonthWord=function(t){var e=t.split(" "),i=r().format("YYYY");return 3===e.length&&i===e[2]?e[0]+" "+e[1]:t},S.prototype.setStartDate=function(t,e){e&&this.startDom().datepicker("setDate",t.toDate()),this.startDate(this.getDateWithoutYearIfMonthWord(n(this.startDom()).val())),this.yearlyDayText(l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_YEARLY_DAYMONTH",{DAYMONTH:t.format(this.getDateMonthFormat())})),this.monthlyDayText(l.i18n("CALENDARWEBCLIENT/LABEL_REPEAT_MONTHLY_DAY",{DAY:t.format("DD")}))},S.prototype.selectStartDate=function(){if(!this.lockSelectStartEndDate()&&this.startDate()&&this.endDate()){this.lockSelectStartEndDate(!0);var t=this.getDateTime(this.startDom(),this.startTime()),e=r(t),i=this.getDateTime(this.endDom(),this.endTime()),s=r(i);h.isNumber(this.iDiffInMinutes)&&(i=(s=e.clone().add(this.iDiffInMinutes,"minutes")).toDate(),this.setEndDate(s,!0),this.endTime(s.format(this.timeFormatMoment))),s.diff(e,"minutes")<0&&(this.setEndDate(e,!0),this.endTime(e.format(this.timeFormatMoment))),this.isEvOneDay(0===s.diff(e,"days")),this.isEvOneTime(0===s.diff(e,"minutes")),this.setStartDate(e,!1),this.startTime(e.format(this.timeFormatMoment)),this.lockSelectStartEndDate(!1)}},S.prototype.getDateMonthFormat=function(){var t=this.dateFormatMoment.slice(0,-5);return-1===n.inArray(t,["MM/DD","DD/MM","DD MMMM"])&&(t="MM/DD"),t},S.prototype.setEndDate=function(t,e){e&&this.endDom().datepicker("setDate",t.toDate()),this.endDate(this.getDateWithoutYearIfMonthWord(n(this.endDom()).val()))},S.prototype.selectEndDate=function(){if(!this.lockSelectStartEndDate()&&this.endDate()&&this.startDate()){this.lockSelectStartEndDate(!0);var t=this.getDateTime(this.startDom(),this.startTime()),e=r(t),i=this.getDateTime(this.endDom(),this.endTime()),s=r(i);this.iDiffInMinutes=s.diff(e,"minutes"),this.iDiffInMinutes<0&&(this.setStartDate(s,!0),this.startTime(s.format(this.timeFormatMoment)),this.iDiffInMinutes=0),this.isEvOneDay(0===s.diff(e,"days")),this.isEvOneTime(0===s.diff(e,"minutes")),this.setEndDate(s,!1),this.endTime(s.format(this.timeFormatMoment)),this.repeatEndDom().datepicker("option","minDate",i),this.isRepeat()||this.repeatEndDom().datepicker("setDate",s.add(7,"days").toDate()),this.lockSelectStartEndDate(!1)}},S.prototype.getDateTime=function(t,e){e=e?r(e,this.timeFormatMoment).format("HH:mm"):"";var i=t.datepicker("getDate"),s=e?e.split(":"):[];return 2===s.length&&null!==i&&(i.setHours(s[0]),i.setMinutes(s[1])),i},S.prototype.setActualTime=function(){if(!this.lockSelectStartEndDate()&&this.endDate()&&this.startDate()){this.lockSelectStartEndDate(!0);var t=r().format(this.timeFormatMoment),e=this.getDateTime(this.startDom(),t),i=r(e),s=this.getDateTime(this.endDom(),t),n=r(s);i.minutes()>30?(i.add(60-i.minutes(),"minutes"),n.add(90-n.minutes(),"minutes")):(i.add(30-i.minutes(),"minutes"),n.add(60-n.minutes(),"minutes")),this.iDiffInMinutes=n.diff(i,"minutes"),this.setStartDate(i,!0),this.startTime(i.format(this.timeFormatMoment)),this.setEndDate(n,!0),this.endTime(n.format(this.timeFormatMoment)),this.lockSelectStartEndDate(!1)}},S.prototype.onSetAppointmentActionResponse=function(t,e){t.Result||u.showErrorByCode(t,l.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},S.prototype.setAppointmentAction=function(t){var e=Enums.IcalConfigInt.NeedsAction,i=this.attendees(),a=d.getAttendee?d.getAttendee(this.attendees()):"",r=s.find(this.attendees(),(function(t){return t.email===a}),this),o=this.calendars.getCalendarById(this.selectedCalendarId()),l={AppointmentAction:t,CalendarId:this.selectedCalendarId(),EventId:this.uid(),Attendee:a};if(r){switch(t){case Enums.IcalConfig.Accepted:e=Enums.IcalConfigInt.Accepted,C.markIcalAccepted(this.uid());break;case Enums.IcalConfig.Tentative:e=Enums.IcalConfigInt.Tentative,C.markIcalTentative(this.uid());break;case Enums.IcalConfig.Declined:e=Enums.IcalConfigInt.Declined,C.markIcalNonexistent(this.uid())}k.send("SetAppointmentAction",l,this.onSetAppointmentActionResponse,this,"CalendarMeetingsPlugin"),r.status=e,this.attendees([]),this.attendees(i),this.setCurrentAttenderStatus(r.email,this.attendees()),t===Enums.IcalConfig.Declined&&o&&this.callbackAttendeeActionDecline&&n.isFunction(this.callbackAttendeeActionDecline)&&(this.callbackAttendeeActionDecline(o,this.id()),this.closePopup())}},S.prototype.editableSwitch=function(t,e,i,s=!1){this.isEditable((t&&e||i)&&!s),this.isEditableReminders(e)},S.prototype.setCurrentAttenderStatus=function(t,e){var i=s.find(e,(function(e){return e.email===t}));this.attenderStatus(i?i.status:0)},S.prototype.getAttenderTextStatus=function(t){switch(t){case 0:t=l.i18n("CALENDARWEBCLIENT/LABEL_ATTENDER_STATUS_PENDING");break;case 1:t=l.i18n("CALENDARWEBCLIENT/LABEL_ATTENDER_STATUS_ACCEPTED");break;case 2:t=l.i18n("CALENDARWEBCLIENT/LABEL_ATTENDER_STATUS_DECLINED");break;case 3:t=l.i18n("CALENDARWEBCLIENT/LABEL_ATTENDER_STATUS_TENTATIVE")}return t},S.prototype.setDayOfWeek=function(){if(this.repeatPeriod()===Enums.CalendarRepeatPeriod.Weekly&&!this.getDays().length)switch(this.getDateTime(this.startDom()).getUTCDay()){case 0:this.weekMO(!0);break;case 1:this.weekTU(!0);break;case 2:this.weekWE(!0);break;case 3:this.weekTH(!0);break;case 4:this.weekFR(!0);break;case 5:this.weekSA(!0);break;case 6:this.weekSU(!0)}},S.prototype.switchTask=function(t){this.isTask(t)},t.exports=new S},"7WqE":function(t,e,i){"use strict";var s=i("xG9w"),n=i("0h2I"),a=i("wd/R"),r=i("AFLV"),o=i("ZP6a"),l=i("IAk5"),h=i("gcBV"),c=i("aM42"),u=i("tqo6");function d(){this.id=0,this.sSyncToken="",this.name=n.observable(""),this.description=n.observable(""),this.owner=n.observable(""),this.isDefault=!1,this.isShared=n.observable(!1),this.isSharedToAll=n.observable(!1),this.sharedToAllAccess=Enums.CalendarAccess.Read,this.isPublic=n.observable(!1),this.url=n.observable(""),this.davUrl=n.observable(""),this.exportUrl=n.observable(""),this.pubUrl=n.observable(""),this.shares=n.observableArray([]),this.events=n.observableArray([]),this.eventsCount=n.computed((function(){return this.events().length}),this),this.access=n.observable(Enums.CalendarAccess.Write),this.color=n.observable(""),this.color.subscribe((function(){this.events(s.map(this.events(),(function(t){return t.backgroundColor=t.borderColor=this.color(),t}),this)),this.name.valueHasMutated()}),this),this.active=n.observable(!0),this.startDateTime=0,this.endDateTime=0,this.canShare=n.computed((function(){return!this.isShared()||this.isShared()&&this.access()===Enums.CalendarAccess.Write&&0!==this.shares().length||this.isOwner()}),this),this.bAllowShare=u.AllowShare,this.bAllowAppointments=u.AllowAppointments,this.subscribed=n.observable(!1),this.source=n.observable("")}d.prototype.parseCssColor=function(t){var e=r.pString(t);return e.length>7?e=e.substr(0,7):e.length>4&&e.length<7&&(e=e.substr(0,4)),4===e.length&&(e=e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.match(/^#[A-Fa-f0-9]{6}$/i)||(e="#f09650"),e},d.prototype.parse=function(t){this.id=r.pString(t.Id),this.sSyncToken=t.SyncToken,this.name(r.pString(t.Name)),this.description(r.pString(t.Description)),this.owner(r.pString(t.Owner)),this.active(!h.hasData(this.id)||h.getData(this.id)),this.isDefault=!!t.IsDefault,this.isShared(!!t.Shared),this.isSharedToAll(!!t.SharedToAll),this.sharedToAllAccess=t.SharedToAllAccess,this.isPublic(!!t.IsPublic),this.access(t.Access),this.color(this.parseCssColor(t.Color)),this.url(r.pString(t.Url)),this.exportUrl(o.getAppPath()+"?calendar-download/"+r.pString(t.ExportHash)),this.pubUrl(o.getAppPath()+"?calendar-pub="+r.pString(t.PubHash)),this.shares(t.Shares||[]),s.each(t.Events,(function(t){this.addEvent(t)}),this),this.subscribed(!!t.Subscribed),this.source(t.Source)},d.prototype.updateEvent=function(t){return t&&(this.removeEvent(t.id),this.addEvent(t)),!1},d.prototype.addEvent=function(t){t&&!this.eventExists(t.id)&&this.events.push(this.parseEvent(t))},d.prototype.getEvent=function(t){return s.find(this.events(),(function(e){return e.id===t}),this)},d.prototype.eventExists=function(t){return!!this.getEvent(t)},d.prototype.getEvents=function(t,e){return s.filter(this.events(),(function(i){var s=t.unix(),n=e.unix(),r=a.utc(i.start).unix(),o=a.utc(i.end).unix();return r>=s&&o<=n||r<=s&&o>=n||r>=s&&r<=n||o<=n&&o>=s}),this)||[]},d.prototype.removeEvent=function(t){this.events(s.filter(this.events(),(function(e){return e.id!==t}),this))},d.prototype.removeEventByUid=function(t,e){this.events(s.filter(this.events(),(function(i){return i.uid!==t||e&&i.excluded}),this))},d.prototype.removeEvents=function(){this.events([])},d.prototype.expungeEvents=function(t,e,i,n){var r=[];s.each(this.getEvents(a.unix(e),a.unix(i)),(function(e){s.include(t,e.id)||e.type!==n||r.push(e.id)}),this),this.events(s.filter(this.events(),(function(t){return!s.include(r,t.id)}),this))},d.prototype.isEditable=function(){return this.access()!==Enums.CalendarAccess.Read},d.prototype.isOwner=function(){return l.getUserPublicId()===this.owner()},d.prototype.parseEvent=function(t){if(t.title=c.getTitleForEvent(t.subject,t.description),t.editable=!t.appointment,t.backgroundColor=t.borderColor=this.color(),!s.isArray(t.className)){var e=t.className;t.className=[e]}return this.access()===Enums.CalendarAccess.Read?(t.className.push("fc-event-readonly"),t.editable=!1):(t.className=s.filter(t.className,(function(t){return"fc-event-readonly"!==t})),this.subscribed()&&(t.editable=!1)),t.rrule&&!t.excluded?t.className.push("fc-event-repeat"):t.className=s.filter(t.className,(function(t){return"fc-event-repeat"!==t})),r.isNonEmptyArray(t.attendees)&&this.bAllowAppointments?t.className.push("fc-event-appointment"):t.className=s.filter(t.className,(function(t){return"fc-event-appointment"!==t})),t.isPrivate&&l.getUserPublicId()!==t.owner&&(t.editable=!1),t.isPrivate?t.className.push("fc-event-private"):t.className=s.filter(t.className,(function(t){return"fc-event-private"!==t})),t},d.prototype.reloadEvents=function(){this.events(s.map(this.events(),(function(t){return this.parseEvent(t)}),this))},t.exports=d},"Ig+v":function(t,e,i){var s=i("0h2I"),n=i("QaF5");function a(t){this.sName="",this.visible=s.observable(!0),this.baseHash=s.observable(""),this.hash=s.observable(""),this.linkText=s.observable(t),this.isCurrent=s.observable(!1),this.recivedAnim=s.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=s.observable(0),this.allowChangeTitle=s.observable(!1),this.inactiveTitle=s.observable(""),this.excludedHashes=s.observableArray([])}a.prototype.ViewTemplate="CoreWebclient_HeaderItemView",a.prototype.setName=function(t){this.sName=t.toLowerCase(),""===this.baseHash()?(this.hash(n.buildHashFromArray([t.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},t.exports=a},KA8O:function(t,e,i){"use strict";var s=i("o0Bx"),n=i("tqo6");s.registerAbortRequestHandler(n.ServerModuleName,(function(t,e){switch(t.Method){case"UpdateEvent":var i=t.Parameters,s=e.Parameters;return"UpdateEvent"===e.Method&&s.calendarId===i.calendarId&&s.uid===i.uid;case"GetCalendars":return"GetCalendars"===e.Method;case"GetEvents":return"GetEvents"===e.Method}return!1})),t.exports={send:function(t,e,i,a,r){s.send(r||n.ServerModuleName,t,e,i,a)}}},PMX0:function(t,e,i){"use strict";var s=i("xG9w"),n=i("wd/R"),a={getTimeListStepHalfHour:function(t){return s.map(["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"],(function(e){var i=n(e,"HH:mm").format(t);return{text:i,value:i}}))},getDateFormatForDatePicker:function(t){return t.replace("MM","mm").replace("DD","dd").replace("YYYY","yy").replace("Month","MM")}};t.exports=a},PfB0:function(t,e,i){"use strict";t.exports={plainToHtml(t){let e=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;");e=e.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a href="$1" target="_blank">$1</a>');e=e.replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>');return e=e.replace(/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,'<a href="mailto:$1">$1</a>'),e.replace(/\r/g,"").replace(/\n/g,"<br />")},htmlToPlain:t=>t.replace(/([^>]{1})<div>/gi,"$1\n").replace(/<style[^>]*>[^<]*<\/style>/gi,"\n").replace(/<br *\/{0,1}>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/div>/gi,"\n").replace(/<a [^>]*href="([^"]*?)"[^>]*>(.*?)<\/a>/gi,"$2").replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"')}},XdVW:function(t,e,i){"use strict";var s=i("xG9w"),n=i("0h2I"),a=i("gcBV"),r=i("7WqE");function o(t){this.parentOnCalendarActiveChange=t.onCalendarActiveChange,this.parentOnCalendarCollectionChange=t.onCalendarCollectionChange,this.defaultCal=n.observable(null),this.currentCal=n.observable(null),this.collection=n.observableArray([]),this.collection.subscribe((function(){this.pickCurrentCalendar(this.defaultCal()),this.parentOnCalendarCollectionChange&&this.parentOnCalendarCollectionChange()}),this),this.count=n.computed((function(){return this.collection().length}),this),this.own=n.computed((function(){return s.filter(this.collection(),(function(t){return!t.isShared()}))}),this),this.ownCount=n.computed((function(){return this.own().length}),this),this.shared=n.computed((function(){return s.filter(this.collection(),(function(t){return t.isShared()&&!t.isSharedToAll()}))}),this),this.sharedCount=n.computed((function(){return this.shared().length}),this),this.sharedToAll=n.computed((function(){return s.filter(this.collection(),(function(t){return t.isShared()&&t.isSharedToAll()}))}),this),this.sharedToAllCount=n.computed((function(){return this.sharedToAll().length}),this),this.ids=n.computed((function(){return s.map(this.collection(),(function(t){return t.id}),this)}),this)}o.prototype.pickCurrentCalendar=function(t){const e=t=>t.active()&&t.isEditable()&&!t.subscribed();if(!this.currentCal()||!e(this.currentCal()))if(t&&e(t))this.currentCal(t);else if(this.defaultCal()&&e(this.defaultCal()))this.currentCal(this.defaultCal());else{let t=this.collection().find(e);t||(t=this.collection().find(t=>t.isEditable()&&!t.subscribed())),t&&this.currentCal(t)}},o.prototype.getCalendarById=function(t){return s.find(this.collection(),(function(e){return e.id===t}),this)},o.prototype.getEvents=function(t,e){var i=[],n=[];return s.each(this.collection(),(function(a){a&&a.active()&&(n=t&&e?a.getEvents(t,e):a.events(),i=s.union(i,n))}),this),i},o.prototype.parseCalendar=function(t){var e=new r;return e.parse(t),e},o.prototype.parseAndAddCalendar=function(t){var e,i=null,s=this.parseCalendar(t);return s.active.subscribe((function(t){this.parentOnCalendarActiveChange(s);var e=s.active()?s:this.defaultCal();this.pickCurrentCalendar(e),a.setData(s.id,t)}),this),s.isDefault&&this.defaultCal(s),(e=this.calendarExists(s.id))||0===e?(i=this.getCalendarById(s.id),s.events(i.events()),this.collection.splice(e,1,s)):this.collection.push(s),s},o.prototype.calendarExists=function(t){var e=s.indexOf(s.map(this.collection(),(function(t){return t.id})),t);return!(e<0)&&e},o.prototype.removeCalendar=function(t){this.collection(s.filter(this.collection(),(function(e){return e.id!==t}),this))},o.prototype.clearCollection=function(){this.collection.removeAll()},o.prototype.getColors=function(){return s.map(this.collection(),(function(t){return t.color().toLowerCase()}),this)},o.prototype.setDefault=function(t){s.each(this.collection(),(function(e){e.id!==t?(e.isDefault=!0,this.defaultCal(e)):e.isDefault=!1}),this)},o.prototype.sort=function(){var t=s.sortBy(this.collection(),(function(t){return t.name()}));this.collection(s.sortBy(t,(function(t){return t.isShared()})))},o.prototype.expunge=function(t){this.collection(s.filter(this.collection(),(function(e){return s.include(t,e.id)}),this))},t.exports=o},aM42:function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("wd/R"),r=i("PMX0"),o=i("tqo6");r.getTimeListStepHour=function(t){return s.map(["01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","00:00"],(function(e){var i=a(e,"HH:mm"),s=i.format(t),n=i.format("H");return"00:00"===e&&(n="24"),{text:s,value:n}}))},r.getTitleForEvent=function(t,e){if(o.AddDescriptionToTitle)return n.trim((t+" "+e).replace(/[\n\r]/g," "));var i=t?n.trim(t.replace(/[\n\r]/," ")):"",s=i.indexOf(" ",180);return s>=0&&(i=i.substring(0,s)+"..."),i.length>200&&(i=i.substring(0,200)+"..."),i},t.exports=r},bvYb:function(t,e,i){"use strict";t.exports=function(t){var e=i("IAk5"),s=i("OgeD");if(e.isUserNormalOrTenant()&&s.isModuleEnabled("CalendarWebclient")){var n=i("RN+F"),a=null;return{getScreens:function(){var t={tasks:function(){return i("tbLT")}};return t},getHeaderItem:function(){if(null===a){var t=i("Ig+v");a=new t(n.i18n("TASKS/ACTION_SHOW_TASKS"))}return{item:a,name:"tasks"}}}}return null}},fIp0:function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("0h2I"),r=i("Yjhd"),o=i("IAk5");function l(t,e){this.bShown=!1,this.currentPage=a.observable(1),this.count=a.observable(t),this.perPage=a.observable(e),this.firstPage=a.observable(1),this.lastPage=a.observable(1),this.pagesCount=a.computed((function(){var t=this.perPage()>0?Math.ceil(this.count()/this.perPage()):0;return t>0?t:1}),this),a.computed((function(){var t=20,e=4,i=this.pagesCount(),s=this.currentPage(),n=s,a=s;if(i>1)for(;t--,1<n&&(n--,e--),0!==e&&(i>a&&(a++,e--),0!==e)&&0!==t;);this.firstPage(n),this.lastPage(a)}),this),this.visibleFirst=a.computed((function(){return this.firstPage()>1}),this),this.visibleLast=a.computed((function(){return this.lastPage()<this.pagesCount()}),this),this.clickPage=s.bind(this.clickPage,this),this.pages=a.computed((function(){var t=this.firstPage(),e=[];if(this.firstPage()<this.lastPage())for(;t<=this.lastPage();t++)e.push({number:t,current:t===this.currentPage(),clickFunc:this.clickPage});return e}),this),o.isMobile()||this.hotKeysBind()}l.prototype.ViewTemplate="CoreWebclient_PageSwitcherView",l.prototype.hotKeysBind=function(){n(document).on("keydown",n.proxy((function(t){if(this.bShown&&!r.isTextFieldFocused()){var e=t.keyCode;t.ctrlKey&&e===Enums.Key.Left?this.clickPreviousPage():t.ctrlKey&&e===Enums.Key.Right&&this.clickNextPage()}}),this))},l.prototype.hide=function(){this.bShown=!1},l.prototype.show=function(){this.bShown=!0},l.prototype.clear=function(){this.currentPage(1),this.count(0)},l.prototype.setCount=function(t){this.count(t),this.currentPage()>this.pagesCount()&&this.currentPage(this.pagesCount())},l.prototype.setPage=function(t,e){this.perPage(e),t>this.pagesCount()?this.currentPage(this.pagesCount()):this.currentPage(t)},l.prototype.clickPage=function(t){var e=t.number;e<1&&(e=1),e>this.pagesCount()&&(e=this.pagesCount()),this.currentPage(e)},l.prototype.clickFirstPage=function(){this.currentPage(1)},l.prototype.clickPreviousPage=function(){var t=this.currentPage()-1;t<1&&(t=1),this.currentPage(t)},l.prototype.clickNextPage=function(){var t=this.currentPage()+1;t>this.pagesCount()&&(t=this.pagesCount()),this.currentPage(t)},l.prototype.clickLastPage=function(){this.currentPage(this.pagesCount())},t.exports=l},gcGb:function(t,e,i){"use strict";var s=i("0h2I"),n=i("xG9w"),a=i("IAk5"),r=i("KA8O");function o(){this.calendars=s.observableArray([]),this.calendarsLoadingStarted=s.observable(!1),this.icalAttachments=[],this.recivedAnim=s.observable(!1).extend({autoResetToFalse:500}),this.calendarSettingsChanged=s.observable(!1),this.calendarChanged=s.observable(!1)}o.prototype.addIcal=function(t){n.each(this.icalAttachments,(function(e){e.uid()===t.uid()&&t.sSequence!==e.sSequence&&(t.sSequence>e.sSequence?e.lastModification(!1):t.lastModification(!1))})),this.icalAttachments.push(t),0===this.calendars().length&&this.requestCalendarList()},o.prototype.getIcal=function(t){return n.find(this.icalAttachments,(function(e){return t===e.file()}))},o.prototype.onGetCalendarsResponse=function(t,e){if(t&&t.Result&&t.Result.Calendars){var i=a.currentAccountEmail?a.currentAccountEmail():"",s=n.filter(t.Result.Calendars,(function(t){return t.Owner===i||t.Access===Enums.CalendarAccess.Full||t.Access===Enums.CalendarAccess.Write}));this.calendars(n.map(s,(function(t){return{name:t.Name+" <"+t.Owner+">",id:t.Id,readonly:t.Subscribed}})))}this.calendarsLoadingStarted(!1)},o.prototype.requestCalendarList=function(){this.calendarsLoadingStarted()||(r.send("GetCalendars",null,this.onGetCalendarsResponse,this),this.calendarsLoadingStarted(!0))},o.prototype.markIcalTypeByFile=function(t,e,i,s,a,r){n.each(this.icalAttachments,(function(n){t===n.file()&&(n.type(e),n.cancelDecision(i),n.replyDecision(s),n.calendarId(a),n.selectedCalendarId(r))}))},o.prototype.markIcalNonexistent=function(t){n.each(this.icalAttachments,(function(e){t===e.uid()&&e.markNeededAction()}))},o.prototype.markIcalNotSaved=function(t){n.each(this.icalAttachments,(function(e){t===e.uid()&&e.markNotSaved()}))},o.prototype.markIcalTentative=function(t){n.each(this.icalAttachments,(function(e){t===e.uid()&&e.markTentative()}))},o.prototype.markIcalAccepted=function(t){n.each(this.icalAttachments,(function(e){t===e.uid()&&e.markAccepted()}))},t.exports=new o},kwPS:function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("0h2I"),r=i("AFLV"),o=i("Yjhd"),l=i("IAk5"),h=i("HLSX"),c=i("76Kh");function u(t,e,i,o,h,c,u,d,p,m,b){this.active=a.observable(!1),this.fSelectCallback=e||function(){},this.fDeleteCallback=i||function(){},this.fDblClickCallback=!l.isMobile()&&o?o:function(){},this.fEnterCallback=h||function(){},this.bResetCheckedOnClick=!!u,this.bCheckOnSelect=!!d,this.bUnselectOnCtrl=!!p,this.bDisableMultiplySelection=!!m,this.bChangeOnSelect=void 0===b||!!b,this.useKeyboardKeys=a.observable(!1),this.list=a.observableArray([]),t&&t.subscribe&&t.subscribe((function(t){this.list(t)}),this),this.multiplyLineFactor=c,this.oLast=null,this.oListScope=null,this.oScrollScope=null,this.iTimer=0,this.iFactor=1,this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Up,this.KeyRight=Enums.Key.Down,this.multiplyLineFactor&&(this.multiplyLineFactor.subscribe?this.multiplyLineFactor.subscribe((function(t){this.iFactor=0<t?t:1}),this):this.iFactor=r.pInt(this.multiplyLineFactor),this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Left,this.KeyRight=Enums.Key.Right,n("html").hasClass("rtl")&&(this.KeyLeft=Enums.Key.Right,this.KeyRight=Enums.Key.Left)),this.sActionSelector="",this.sSelectableSelector="",this.sCheckboxSelector="";var f=this;this.listChecked=a.computed({read:function(){return s.filter(this.list(),(function(t){var e=t&&t.checked&&t.checked(),i=t&&t.selected&&t.selected();return e||f.bCheckOnSelect&&i}))},write:function(t){t=!!t,s.each(this.list(),(function(e){e.checked(t)})),this.list.valueHasMutated()},owner:this}),this.checkAll=a.computed({read:function(){return 0<this.listChecked().length},write:function(t){this.listChecked(!!t)},owner:this}),this.selectorHook=a.observable(null),this.selectorHook.subscribe((function(){this.active()&&this.selectorHook()&&this.selectorHook().selected(!1)}),this,"beforeChange"),this.selectorHook.subscribe((function(){this.active()&&this.selectorHook()&&this.selectorHook().selected(!0)}),this),this.itemSelected=a.computed({read:this.selectorHook,write:function(t){this.selectorHook(t),t&&(f.scrollToSelected(),this.oLast=t)},owner:this}),this.list.subscribe((function(t){const e=this.itemSelected();if(Array.isArray(t)&&e){!!t.find(t=>"function"==typeof e.isEqual?e.isEqual(t):e===t)||this.itemSelected(null)}else this.itemSelected(null)}),this),this.listCheckedOrSelected=a.computed({read:function(){var t=this.itemSelected(),e=this.listChecked();return 0<e.length?e:t?[t]:[]},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.listCheckedAndSelected=a.computed({read:function(){var t=[],e=this.itemSelected(),i=this.listChecked();return i&&(t=i.slice(0)),e&&-1===s.indexOf(i,e)&&t.push(e),t},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.isIncompleteChecked=a.computed((function(){var t=this.list().length,e=this.listChecked().length;return 0<t&&0<e&&t>e}),this),this.onKeydownBound=s.bind(this.onKeydown,this)}u.prototype.iTimer=0,u.prototype.bResetCheckedOnClick=!1,u.prototype.bCheckOnSelect=!1,u.prototype.bUnselectOnCtrl=!1,u.prototype.bDisableMultiplySelection=!1,u.prototype.getLastOrSelected=function(){var t=0,e=null;return s.each(this.list(),(function(i){i&&s.isFunction(i.checked)&&(i.checked()&&t++,i.selected()&&(e=i))})),0===t&&e?e:this.oLast},u.prototype.unbind=function(){this.active(!1),this.itemSelected()&&this.itemSelected().selected(!1),n(document).off("keydown",this.onKeydownBound),n(this.oListScope).off()},u.prototype.initOnApplyBindings=function(t,e,i,s,r){this.active(!0),n(document).on("keydown",this.onKeydownBound),this.oListScope=s,this.oScrollScope=r,this.sActionSelector=t,this.sSelectableSelector=e,this.sCheckboxSelector=i;var o=this,l=function(t,e,i){var s=0,n=0,a=null,r=!1,l=!1,h=[],c=!1;if(e=e||null,i&&i.shiftKey&&null!==e&&null!==t&&e!==t)for(h=o.list(),c=e.checked(),s=0,n=h.length;s<n;s++)r=!1,(a=h[s])!==t&&a!==e||(r=!0),r&&(l=!l),(l||r)&&a&&a.checked&&a.checked(c);e&&(o.oLast=e)};n(this.oListScope).on("dblclick",t,(function(t){var e=a.dataFor(this);!e||!t||t.ctrlKey||t.altKey||t.shiftKey||o.onDblClick(e)})),h.mobileDevice&&n(this.oListScope).on("touchstart",t,(function(t){if(t){var e=t.timeStamp,i=e-(n(this).data("lastTouch")||e),s=t.originalEvent&&t.originalEvent.touches?t.originalEvent.touches.length:0;n(this).data("lastTouch",e),!i||i>250||s>1||(t.preventDefault(),n(this).trigger("dblclick"))}})),n(this.oListScope).on("click",t,(function(t){var e=!0,i=null,s=o.getLastOrSelected(),n=a.dataFor(this);n&&t&&(t.shiftKey?(e=!1,o.bDisableMultiplySelection||(null===o.oLast&&(o.oLast=n),n.checked(!n.checked()),l(s,n,t))):(t.ctrlKey||t.metaKey)&&(e=!1,o.bDisableMultiplySelection||(o.oLast=n,!(i=o.itemSelected())||i.checked()||n.checked()||i.checked(!0),o.bUnselectOnCtrl&&n===o.itemSelected()?(n.checked(!n.selected()),o.itemSelected(null)):n.checked(!n.checked()))),e&&o.selectionFunc(n))})),n(this.oListScope).on("click",i,(function(t){var e=a.dataFor(this);e&&t&&!o.bDisableMultiplySelection&&(t.shiftKey?(null===o.oLast&&(o.oLast=e),l(o.getLastOrSelected(),e,t)):o.oLast=e),t&&t.stopPropagation&&t.stopPropagation()})),n(this.oListScope).on("dblclick",i,(function(t){t&&t.stopPropagation&&t.stopPropagation()}))},u.prototype.getResultSelection=function(t,e){var i=this,a=!1,r=!1,o=null,l=this.iFactor,h=!!this.multiplyLineFactor,c=0,u=0,d=[];if(!t&&-1<n.inArray(e,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]))(d=this.list())&&0<d.length&&(-1<n.inArray(e,[this.KeyDown,this.KeyRight,Enums.Key.PageUp,Enums.Key.Home])?o=d[0]:-1<n.inArray(e,[this.KeyUp,this.KeyLeft,Enums.Key.PageDown,Enums.Key.End])&&(o=d[d.length-1]));else if(t&&0<(u=(d=this.list())?d.length:0))if(Enums.Key.Home===e||Enums.Key.PageUp===e||Enums.Key.End===e||Enums.Key.PageDown===e||h&&(Enums.Key.Left===e||Enums.Key.Right===e)||!h&&(Enums.Key.Up===e||Enums.Key.Down===e))s.each(d,(function(s){if(!a)switch(e){case i.KeyUp:case i.KeyLeft:t===s?a=!0:o=s;break;case Enums.Key.Home:case Enums.Key.PageUp:o=s,a=!0;break;case i.KeyDown:case i.KeyRight:r?(o=s,a=!0):t===s&&(r=!0);break;case Enums.Key.End:case Enums.Key.PageDown:o=s}}));else if(h&&this.KeyDown===e){for(;c<u;c++)if(t===d[c]){u-1<(c+=l)&&(c-=l),o=d[c];break}}else if(h&&this.KeyUp===e)for(c=u;c>=0;c--)if(t===d[c]){0>(c-=l)&&(c+=l),o=d[c];break}return o},u.prototype.shiftClickResult=function(t,e,i){if(e){var a=!!this.multiplyLineFactor,r=!1,o=!1;-1<n.inArray(i,a?[Enums.Key.Left,Enums.Key.Right]:[Enums.Key.Up,Enums.Key.Down])?e.checked(!e.checked()):-1<n.inArray(i,a?[Enums.Key.Up,Enums.Key.Down,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]:[Enums.Key.Left,Enums.Key.Right,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&(o=!e.checked(),s.each(this.list(),(function(i){var s=!1;i!==t&&e!==i||(r=!r,s=!0),(r||s)&&(i.checked(o),s=!1)})),a&&t&&(i===Enums.Key.Up||i===Enums.Key.Down)&&t.checked(!t.checked()))}},u.prototype.clickNewSelectPosition=function(t,e){var i=this.itemSelected(),s=this.getResultSelection(i,t);s&&(e&&this.shiftClickResult(s,i,t),this.selectionFunc(s))},u.prototype.onKeydown=function(t){var e=!0,i=0;return this.useKeyboardKeys()&&t&&!o.isTextFieldFocused()&&!c.hasOpenedMaximizedPopups()&&(i=t.keyCode,t.ctrlKey||this.KeyUp!==i&&this.KeyDown!==i&&this.KeyLeft!==i&&this.KeyRight!==i&&Enums.Key.PageUp!==i&&Enums.Key.PageDown!==i&&Enums.Key.Home!==i&&Enums.Key.End!==i?Enums.Key.Del!==i||t.ctrlKey||t.shiftKey?Enums.Key.Enter===i?0<this.list().length&&!t.ctrlKey&&(this.onEnter(this.itemSelected()),e=!1):!t.ctrlKey||t.altKey||t.shiftKey||Enums.Key.a!==i||(this.checkAll(!(this.checkAll()&&!this.isIncompleteChecked())),e=!1):0<this.list().length&&(this.onDelete(),e=!1):(this.clickNewSelectPosition(i,t.shiftKey),e=!1)),e},u.prototype.onDelete=function(){this.fDeleteCallback.call(this,this.listCheckedOrSelected())},u.prototype.onEnter=function(t){t&&this.fEnterCallback.call(this,t)},u.prototype.selectionFunc=function(t){this.bChangeOnSelect&&this.itemSelected(null),this.bResetCheckedOnClick&&this.listChecked(!1),this.bChangeOnSelect&&this.itemSelected(t),this.fSelectCallback.call(this,t)},u.prototype.onDblClick=function(t){this.fDblClickCallback.call(this,t)},u.prototype.koCheckAll=function(){return a.computed({read:this.checkAll,write:this.checkAll,owner:this})},u.prototype.koCheckAllIncomplete=function(){return a.computed({read:this.isIncompleteChecked,write:this.isIncompleteChecked,owner:this})},u.prototype.scrollToSelected=function(){if(!(this.oListScope&&this.oScrollScope&&this.oScrollScope[0]&&this.oScrollScope[0].isConnected))return!1;var t=n(this.sSelectableSelector,this.oScrollScope),e=t[0]?t[0].offsetTop:void 0,i=this.oScrollScope.height(),s=this.oScrollScope.scrollTop(),a=t.outerHeight();return!(e&&e>=s&&e<=s+i-a)&&(e<s+i&&e+a>s+i?this.oScrollScope.scrollTop(e+a+20-i):this.oScrollScope.scrollTop(e-20),!0)},t.exports=u},nKlx:function(t,e,i){"use strict";var s=i("RN+F"),n={getMonthNamesArray:function(){for(var t=s.i18n("COREWEBCLIENT/LIST_MONTH_NAMES").split(" "),e=t.length;e<12;e++)t[e]="";return t},daysInMonth:function(t,e){return 0<t&&13>t&&0<e?new Date(e,t,0).getDate():31}};t.exports=n},nKzX:function(t,e,i){"use strict";(function(e){const s=i("0h2I");function n(){this.visibleLinkPopup=s.observable(!1),this.linkPopupDom=s.observable(null),this.linkHrefDom=s.observable(null),this.linkHref=s.observable(""),this.visibleLinkHref=s.observable(!1),this.allowEditLinks=s.observable(!1),this.currLink=!1,this.onBodyClick=function(t){0===e(t.target).parents("div.inline_popup").length&&this.closeAllPopups()}.bind(this)}n.prototype.PopupTemplate="CalendarWebclient_LinkPopupEditableView",n.prototype.onOpen=function(){e(document.body).on("click",this.onBodyClick)},n.prototype.onClose=function(){e(document.body).off("click",this.onBodyClick)},n.prototype.initInputField=function(t,e){t.on("click","a",function(i){if(i.ctrlKey)window.open(i.target.href,"_blank");else{const s=i.currentTarget;this.visibleLinkPopup()&&s===this.currLink?(this.currLink=null,this.hideLinkPopup()):(this.allowEditLinks(e),this.showLinkPopup(s,t))}i.preventDefault(),i.stopPropagation()}.bind(this))},n.prototype.showLinkPopup=function(t,i){const s=e(t),n=i.parents("div.row").position(),a=s.position(),r=s.height(),o={left:Math.round(a.left+n.left),top:Math.round(a.top+r+n.top)};this.currLink=t,this.linkHref(s.attr("href")||s.text()),e(this.linkPopupDom()).css(o),e(this.linkHrefDom()).css(o),this.visibleLinkPopup(!0)},n.prototype.hideLinkPopup=function(){this.visibleLinkPopup(!1)},n.prototype.showChangeLink=function(){this.visibleLinkHref(!0),this.hideLinkPopup()},n.prototype.changeLink=function(){this.changeLinkHref(this.linkHref()),this.hideChangeLink()},n.prototype.hideChangeLink=function(){this.visibleLinkHref(!1)},n.prototype.normaliseURL=function(t){return-1!==t.search(/^https?:\/\/|^mailto:|^tel:/g)?t:"http://"+t},n.prototype.changeLinkHref=function(t){const i=this.normaliseURL(t),s=e(this.currLink);s&&(s.attr("href")===s.text()&&s.text(i),s.attr("href",i),this.currLink=null)},n.prototype.removeCurrentLink=function(){if(this.currLink&&document.createRange&&window.getSelection){const t=document.createRange(),e=window.getSelection();t.selectNodeContents(this.currLink),e.removeAllRanges(),e.addRange(t),window.document.execCommand("unlink"),this.currLink=null,this.hideLinkPopup()}},n.prototype.closeAllPopups=function(){this.currLink=null,this.hideLinkPopup(),this.hideChangeLink()},t.exports=n}).call(this,i("EVdn"))},tbLT:function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("0h2I"),r=i("wd/R"),o=i("RN+F"),l=i("AFLV"),h=i("Yjhd"),c=i("o0Bx"),u=i("JFZZ"),d=i("xcwT"),p=i("kwPS"),m=i("fIp0"),b=i("76Kh"),f=i("hPb3"),v=i("XdVW"),y=(i("7WqE"),i("1xZj"));function E(){this.sDateFormat=f.dateFormat(),this.dateFormatMoment=h.getDateFormatForMoment(this.sDateFormat),this.saveCommand=h.createCommand(this,this.executeSave),this.removeCommand=h.createCommand(this,this.executeRemove),this.calendars=new v({onCalendarCollectionChange:function(){},onCalendarActiveChange:function(){}}),d.call(this,"Tasks"),this.iItemsPerPage=20,this.browserTitle=a.observable(o.i18n("TASKS/HEADING_BROWSER_TAB")),this.tasksList=a.observableArray([]),this.hiddenTasksList=a.observableArray([]),this.selectedItem=a.observable(null),this.isSearchFocused=a.observable(!1),this.searchInput=a.observable(""),this.selector=new p(this.tasksList,s.bind(this.viewItem,this),this.executeRemove,s.bind(this.taskClickCallback,this)),this.searchClick=a.observable(!1),this.isSearch=a.computed((function(){return""!==this.searchInput()&&this.searchClick()}),this),this.pageSwitcherLocked=a.observable(!1),this.oPageSwitcher=new m(0,this.iItemsPerPage),this.oPageSwitcher.currentPage.subscribe((function(t){this.currentPage(t),this.getTasks()}),this),this.currentPage=a.observable(1),this.loadingList=a.observable(!1),this.preLoadingList=a.observable(!1),this.loadingList.subscribe((function(t){this.preLoadingList(t)}),this),this.sTimeFormat=a.computed((function(){return f.timeFormat()===Enums.TimeFormat.F24?"HH:mm":"hh:mm A"}),this),this.isEmptyList=a.computed((function(){return 0===this.tasksList().length}),this),this.searchText=a.observable(""),this.showCompleted=a.observable(!1),this.actionCompletedText=a.computed((function(){return this.showCompleted()?o.i18n("TASKS/ACTION_HIDE_COMPLETED"):o.i18n("TASKS/ACTION_SHOW_COMPLETED")}),this)}i("Vn+K"),s.extendOwn(E.prototype,d.prototype),E.prototype.ViewTemplate="Tasks_MainView",E.prototype.ViewConstructorName="CMainView",E.prototype.onShow=function(){this.getCalendars()},E.prototype.getCalendars=function(){this.loadingList(!0),c.send("Calendar","GetCalendars",{IsPublic:!1},this.onGetCalendarsResponse,this)},E.prototype.onGetCalendarsResponse=function(t,e){var i=[],n=[],a=null,r=null,o=this;t.Result&&(s.each(t.Result.Calendars,(function(e){if(!(a=this.calendars.parseCalendar(e)).isShared()&&(i.push(a.id),r=this.calendars.getCalendarById(a.id),(this.needsToReload||(r&&r.sSyncToken)!==(a&&a.sSyncToken))&&(a=this.calendars.parseAndAddCalendar(e)))){var h=a.id;a.active.subscribe((function(t){s.each(o.tasksList(),(function(e){e.calendarId===h&&e.visible(t)}))}),a),a.davUrl(l.pString(t.Result.ServerUrl)),n.push(a.id)}}),this),this.calendars.expunge(i),this.getTasks(i))},E.prototype.getTasks=function(t){this.loadingList(!0),c.send("Calendar","GetTasks",{CalendarIds:t,Completed:this.showCompleted(),Search:this.searchInput()},this.onGetTasksResponse,this)},E.prototype.prepareTask=function(t){var e=this,i=e.calendars.getCalendarById(t.calendarId);if(t.visibleDate=a.observable(""),t.withDate=a.observable(!1),t.start&&t.end){t.withDate(!0),t.start=r(t.start),t.end=r(t.end);var s=t.start.clone(),n=t.end.clone();n&&t.allDay&&n.subtract(1,"days");var o=0===n.diff(s,"days"),l=0===n.diff(s,"minutes"),h=e.getDateWithoutYearIfMonthWord(s.format(e.dateFormatMoment)),c=o?"":" - "+e.getDateWithoutYearIfMonthWord(n.format(e.dateFormatMoment)),u=t.allDay?"":", "+s.format(this.sTimeFormat()),d=t.allDay||l?"":(o?" - ":", ")+n.format(this.sTimeFormat());t.visibleDate=a.observable(h+u+c+d)}return t.selected=a.observable(!1),t.checked=a.observable(t.status),t.visible=a.observable(i.active()),t.color=i.color,t.checked.subscribe((function(i){e.updateTaskStatus(t)})),t},E.prototype.getTaskFromList=function(t){return s.find(this.tasksList(),(function(e){return e.uid===t}))},E.prototype.onGetTasksResponse=function(t){var e=t.Result,i=this;if(e){var n=l.isNonEmptyArray(e)?s.compact(s.map(e,(function(t){return i.prepareTask(t)}))):[];this.tasksList(n),this.sortTasksList(),this.loadingList(!1)}},E.prototype.viewItem=function(t){this.selectedItem(t)},E.prototype.onBind=function(){this.selector.initOnApplyBindings(".sales_sub_list .item",".sales_sub_list .selected.item",".sales_sub_list .selected.item",n(".sales_list",this.$viewDom),n(".sales_list_scroll.scroll-inner",this.$viewDom))},E.prototype.searchSubmit=function(){""!==this.searchInput()?this.searchText(o.i18n("TASKS/INFO_SEARCH_RESULT",{SEARCH:this.searchInput()})):this.searchText(""),this.searchClick(!0),this.tasksList([]),this.getCalendars()},E.prototype.onClearSearchClick=function(){this.searchInput(""),this.searchText(""),this.searchClick(!1),this.searchSubmit()},E.prototype.createTaskInCurrentCalendar=function(){this.calendars.pickCurrentCalendar(),this.createTaskToday(this.calendars.currentCal())},E.prototype.createTaskToday=function(t){this.openTaskPopup(t,null,null,!1)},E.prototype.openTaskPopup=function(t,e,i,n){t&&b.showPopup(y,[{CallbackSave:s.bind(this.createTask,this),CallbackDelete:null,Calendars:this.calendars,SelectedCalendar:t?t.id:0,Start:e,End:i,AllDay:n,TimeFormat:this.sTimeFormat(),DateFormat:f.dateFormat(),Type:"VTODO",IsTaskApp:!0}])},E.prototype.getParamsFromEventData=function(t){return{id:t.id,uid:t.uid,calendarId:t.calendarId,newCalendarId:t.newCalendarId||t.calendarId,subject:t.subject,allDay:t.allDay?1:0,location:t.location,description:t.description,alarms:t.alarms?JSON.stringify(t.alarms):"[]",attendees:t.attendees?JSON.stringify(t.attendees):"[]",owner:t.owner,recurrenceId:t.recurrenceId,excluded:t.excluded,allEvents:t.allEvents,modified:t.modified?1:0,start:t.start.local().toDate(),end:t.end.local().toDate(),startTS:t.start.unix(),endTS:(t.end,t.end.unix()),rrule:t.rrule?JSON.stringify(t.rrule):null,type:t.type,status:t.status,withDate:t.withDate}},E.prototype.createTask=function(t){var e=this.getParamsFromEventData(t);e.calendarId=t.newCalendarId,c.send("Calendar","CreateEvent",e,this.onCreateTaskResponse,this)},E.prototype.sortTasksList=function(){this.tasksList.sort((function(t,e){return null!==t.startTS&&null!==e.startTS?t.startTS===e.startTS?0:t.startTS>e.startTS?1:-1:null===t.startTS&&null===e.startTS?t.lastModified===e.lastModified?0:t.lastModified>e.lastModified?1:-1:null===t.startTS?1:null===e.startTS?-1:void 0}))},E.prototype.onCreateTaskResponse=function(t){var e=t.Result;if(e){var i=this.prepareTask(e.Events[0]);this.tasksList.push(i),this.sortTasksList()}else u.showErrorByCode(t)},E.prototype.taskClickCallback=function(t){s.bind((function(e){var i={ID:t.id,Uid:t.uid,RecurrenceId:t.recurrenceId,Calendars:this.calendars,SelectedCalendar:t.calendarId,AllDay:t.allDay,Location:t.location,Description:t.description,Subject:t.subject,Alarms:t.alarms,Attendees:t.attendees,RRule:t.rrule,Excluded:!1,Owner:t.owner,Appointment:!1,OwnerName:t.ownerName,TimeFormat:this.sTimeFormat(),DateFormat:f.dateFormat(),AllEvents:e,CallbackSave:s.bind(this.updateTask,this),CallbackDelete:s.bind(this.executeRemove,this),Type:t.type,Status:t.status,IsTaskApp:!0};e!==Enums.CalendarEditRecurrenceEvent.None&&(t.start&&t.end&&(i.Start=t.start.clone(),i.Start=i.Start.local(),i.End=t.end.clone(),i.End=i.End.local()),b.showPopup(y,[i]))}),this)(Enums.CalendarEditRecurrenceEvent.AllEvents)},E.prototype.updateTask=function(t){var e=this.getParamsFromEventData(t);c.send("Calendar","UpdateEvent",e,this.onUpdateTaskResponse,this)},E.prototype.onUpdateTaskResponse=function(t,e){var i=t.Result;if(i){var n=i.Events[0].uid,a=this.getTaskFromList(n);if(a){a=this.prepareTask(i.Events[0]);var r=s.findIndex(this.tasksList(),(function(t){return t.uid===n}));r>=0&&this.tasksList.splice(r,1,a),this.sortTasksList()}}else u.showErrorByCode(t)},E.prototype.executeRemove=function(t){c.send("Calendar","DeleteEvent",{calendarId:t.calendarId,uid:t.uid},this.onDeleteTaskResponse,this)},E.prototype.onDeleteTaskResponse=function(t,e){if(t.Result){var i=e.Parameters.uid;this.getTaskFromList(i)&&this.tasksList(s.without(this.tasksList(),s.findWhere(this.tasksList(),{uid:i})))}else u.showErrorByCode(t)},E.prototype.updateTaskStatus=function(t){c.send("Calendar","UpdateTask",{CalendarId:t.calendarId,TaskId:t.uid,Subject:t.subject,Status:t.checked(),WithDate:t.withDate()},this.onUpdateTaskStatusResponse,this)},E.prototype.onUpdateTaskStatusResponse=function(t,e){t.Result||u.showErrorByCode(t)},E.prototype.getDateWithoutYearIfMonthWord=function(t){var e=t.split(" "),i=r().format("YYYY");return 3===e.length&&i===e[2]?e[0]+" "+e[1]:t},E.prototype.onShowCompletedClick=function(){this.showCompleted(!this.showCompleted()),this.searchSubmit()},t.exports=new E},tqo6:function(t,e,i){"use strict";var s=i("xG9w"),n=i("EVdn"),a=i("AFLV");t.exports={ServerModuleName:"Calendar",HashModuleName:"calendar",ServerMeetingsPluginName:"CalendarMeetingsPlugin",ServerCorporateCalendarName:"CorporateCalendar",AddDescriptionToTitle:!1,AllowAppointments:!0,AllowShare:!1,AllowTasks:!0,DefaultTab:"3",HighlightWorkingDays:!0,HighlightWorkingHours:!0,PublicCalendarId:"",WeekStartsOn:"0",WorkdayEnds:"18",WorkdayStarts:"9",AllowSubscribedCalendars:!1,AllowPrivateEvents:!0,init:function(t){var e=t[this.ServerModuleName],i=t[this.ServerMeetingsPluginName],r=t[this.ServerCorporateCalendarName];s.isEmpty(e)||(this.AddDescriptionToTitle=a.pBool(e.AddDescriptionToTitle,this.AddDescriptionToTitle),this.AddDescriptionToTitle&&n("html").addClass("AddDescriptionToTitle"),s.isEmpty(r)||(this.AllowShare=a.pBool(r.AllowShare,this.AllowShare)),this.AllowTasks=a.pBool(e.AllowTasks,this.AllowTasks),this.DefaultTab=a.pString(e.DefaultTab,this.DefaultTab),this.HighlightWorkingDays=a.pBool(e.HighlightWorkingDays,this.HighlightWorkingDays),this.HighlightWorkingHours=a.pBool(e.HighlightWorkingHours,this.HighlightWorkingHours),this.PublicCalendarId=a.pString(e.PublicCalendarId,this.PublicCalendarId),this.WeekStartsOn=a.pString(e.WeekStartsOn,this.WeekStartsOn),this.WorkdayEnds=a.pString(e.WorkdayEnds,this.WorkdayEnds),this.WorkdayStarts=a.pString(e.WorkdayStarts,this.WorkdayStarts),this.AllowSubscribedCalendars=a.pBool(e.AllowSubscribedCalendars,this.AllowSubscribedCalendars),this.AllowPrivateEvents=a.pBool(e.AllowPrivateEvents,this.AllowPrivateEvents)),s.isEmpty(i)||(this.AllowAppointments=a.pBool(i.AllowAppointments,this.AllowAppointments))},update:function(t,e,i,s,n,a){this.DefaultTab=a.toString(),this.HighlightWorkingDays=t,this.HighlightWorkingHours=e,this.WeekStartsOn=n.toString(),this.WorkdayEnds=s.toString(),this.WorkdayStarts=i.toString()}}},"w7/9":function(t,e,i){"use strict";const s=i("0h2I"),n=i("AFLV"),a=i("PfB0");function r({isEditableObservable:t,autosizeTriggerObservable:e,linkPopupEditableView:i,allowEditLinks:r,placeholderText:o}){this.isEditable=t,this.autosizeTrigger=e,this.placeholderText=o,this.dataHtml=s.observable(""),this.dataDom=s.observable(null),this.dataDom.subscribe((function(){this.dataDom()&&(this.dataDom().on("keyup paste cut",function(t){t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||this.dataHtml(this.dataDom().html())}.bind(this)),this.dataDom().on("paste",(function(t){const e=(t=t.originalEvent||t).clipboardData||window.clipboardData;if(e){const i=n.pString(e.getData("text")),s=a.plainToHtml(i);window.document.execCommand("insertHTML",!1,s),t.preventDefault()}})),i.initInputField(this.dataDom(),r))}),this),this.dataFocus=s.observable(!1)}r.prototype.PopupTemplate="CalendarWebclient_SimpleEditableView",r.prototype.getHtml=function(){return this.dataHtml()},r.prototype.getPlain=function(){return a.htmlToPlain(this.dataHtml())},r.prototype.setHtml=function(t){this.dataHtml(n.pString(t).replace(/\r/g,"").replace(/\n/g,"<br />")),this.dataDom().html(this.dataHtml())},r.prototype.setPlain=function(t){this.dataHtml(a.plainToHtml(n.pString(t))),this.dataDom().html(this.dataHtml())},t.exports=r}}]);