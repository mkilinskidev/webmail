(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{L1t5:function(t,o,e){"use strict";var i=e("xG9w"),s=e("AFLV");t.exports={ServerModuleName:"MailSignup",HashModuleName:"signup",CustomLogoUrl:"",InfoText:"",BottomInfoHtmlText:"",DomainList:[],init:function(t){var o=t.MailSignup;if(!i.isEmpty(o)){var e=s.pArray(o.DomainList,this.DomainList);this.ServerModuleName=s.pString(o.ServerModuleName,this.ServerModuleName),this.HashModuleName=s.pString(o.HashModuleName,this.HashModuleName),this.CustomLogoUrl=s.pString(o.CustomLogoUrl,this.CustomLogoUrl),this.InfoText=s.pString(o.InfoText,this.InfoText),this.BottomInfoHtmlText=s.pString(o.BottomInfoHtmlText,this.BottomInfoHtmlText),this.DomainList=s.isNonEmptyArray(e)?e:["no domain set"]}}}},WNT9:function(t,o,e){"use strict";t.exports=function(t){var o=e("IAk5"),i=e("L1t5"),s=o.getUserRole()===Enums.UserRole.Anonymous;return i.init(t),!o.isPublic()&&s?o.isMobile()?{getSignupScreenView:function(){return e("i2mW")},getHashModuleName:function(){return i.HashModuleName}}:{getScreens:function(){var t={};return t[i.HashModuleName]=function(){return e("i2mW")},t}}:null}},i2mW:function(t,o,e){"use strict";var i=e("xG9w"),s=e("EVdn"),n=e("0h2I"),r=e("RN+F"),a=e("ZP6a"),l=e("Yjhd"),u=e("o0Bx"),h=e("JFZZ"),m=e("IAk5"),p=e("HLSX"),c=e("xcwT"),d=e("SQrT"),g=e("L1t5"),b=s("html");function f(){c.call(this,"MailSignup"),this.sCustomLogoUrl=g.CustomLogoUrl,this.sInfoText=g.InfoText,this.sBottomInfoHtmlText=g.BottomInfoHtmlText,this.aDomainList=n.observableArray(g.DomainList),this.sSelectedDomain=n.observable(""),this.name=n.observable(""),this.enableNameEdit=n.observable(!0),this.login=n.observable(""),this.enableLoginEdit=n.observable(!0),this.password=n.observable(""),this.confirmPassword=n.observable(""),this.nameFocus=n.observable(!1),this.loginFocus=n.observable(!1),this.passwordFocus=n.observable(!1),this.confirmPasswordFocus=n.observable(!1),this.loading=n.observable(!1),this.canTrySignup=n.computed((function(){return!this.loading()}),this),this.signupButtonText=n.computed((function(){return this.loading()?r.i18n("MAILSIGNUP/ACTION_SIGNUP_IN_PROGRESS"):r.i18n("MAILSIGNUP/ACTION_SIGNUP")}),this),this.signupCommand=l.createCommand(this,this.signup,this.canTrySignup),this.shake=n.observable(!1).extend({autoResetToFalse:800}),this.beforeButtonsControllers=n.observableArray([]),m.broadcastEvent("AnonymousUserForm::PopulateBeforeButtonsControllers",{ModuleName:"MailSignup",RegisterBeforeButtonsController:this.registerBeforeButtonsController.bind(this)}),this.welcomeText=n.observable(""),m.subscribeEvent("ShowWelcomeSignupText",i.bind((function(t){this.welcomeText(t.WelcomeText),this.login(t.UserName),this.enableLoginEdit(!1)}),this)),m.broadcastEvent("MailSignup::ConstructView::after",{Name:this.ViewConstructorName,View:this})}i.extendOwn(f.prototype,c.prototype),f.prototype.ViewTemplate="MailSignup_MainView",f.prototype.ViewConstructorName="CMainView",f.prototype.onBind=function(){b.addClass("non-adjustable-valign")},f.prototype.onShow=function(){i.delay(i.bind((function(){""===this.login()&&this.loginFocus(!0)}),this),1)},f.prototype.validateForm=function(t,o,e){return""===t?(this.loginFocus(!0),this.shake(!0),!1):""===o?(this.passwordFocus(!0),this.shake(!0),!1):""===o||o===e||(this.confirmPasswordFocus(!0),this.shake(!0),d.showError(r.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")),!1)},f.prototype.signup=function(){if(!this.loading()){var t=s.trim(this.name()),o=s.trim(this.login())+"@"+this.sSelectedDomain(),e=s.trim(this.password()),i=s.trim(this.confirmPassword()),n={Name:t,Login:o,Password:e};m.broadcastEvent("AnonymousUserForm::PopulateFormSubmitParameters",{Module:"MailSignup",Parameters:n}),this.validateForm(o,e,i)&&(this.loading(!0),u.send("MailSignup","Signup",n,this.onSignupResponse,this))}},f.prototype.onSignupResponse=function(t,o){!1===t.Result?(this.loading(!1),this.shake(!0),h.showErrorByCode(t,r.i18n("MAILSIGNUP/ERROR_SIGNUP_FAILED"))):(m.setAuthToken(t.Result.AuthToken),""!==window.location.search&&null===a.getRequestParam("reset-pass")&&null===a.getRequestParam("invite-auth")&&null===a.getRequestParam("oauth")?a.clearAndReloadLocation(p.ie8AndBelow,!0):a.clearAndReloadLocation(p.ie8AndBelow,!1))},f.prototype.registerBeforeButtonsController=function(t){this.beforeButtonsControllers.push(t)},t.exports=new f}}]);